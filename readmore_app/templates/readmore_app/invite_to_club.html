{% extends parent_template|default:"base.html" %}
{% load static %}

{% block title %}
Readmore - {{ club.club_name }}
{% endblock %}

{% block content %}
<div class="basic_card">
    <h1> Invite Users to {{ club.club_name }}</h1>
    <table>
    {% for friend in real_user.user_friends.all %}
        <tr id="friend{{ friend.id }}">
            <td style="padding-left: 20px;">
                <p><a href="{% url 'readmore_app:profile' friend.id %}" class="anchor_button">@{{ friend.username }}</a>{% if friend in club.club_users.all %}[Joined]{% endif %}</p>
            </td>
            <td style="padding-left: 20px;">
                <p id="invitebutton{{ friend.id }}">
                {% if friend not in club.club_users.all and friend not in club.club_pending_invites.all %}
                <button onclick="inviteMember({{ friend.id }}, {{ club.club_id }});">Send Invite</button>
                {% elif friend in club.club_pending_invites.all %}
                Pending...
                {% endif %}
                </p>
            </td>
        </tr>
        <tr id="friend{{ friend.id }}underline"><td colspan="2" bgcolor="lightgray"><td></tr>
    {% endfor %}
    </table>
    <a class="anchor_button" style="top: 20px; left: 20px; position: relative;" href="{% url 'readmore_app:club' club.club_id %}">Back To Club Home</a>
</div>
{% endblock %}

{% block js %}
function inviteMember(friend_id, club_id) {
    const invitebutton = document.getElementById("invitebutton" + friend_id);
    invitebutton.innerHTML = "Pending...";
    const xhrinvitemember = new XMLHttpRequest();
    xhrinvitemember.open("GET", "/readmore/ajax/invite_member/" + club_id + "/" + friend_id + "/");
    xhrinvitemember.send();
}
{% endblock %}